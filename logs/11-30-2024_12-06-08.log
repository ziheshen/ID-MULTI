11/30/2024 12:06:08 - INFO - __main__ - Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda

Mixed precision type: no

11/30/2024 12:06:12 - INFO - root - freeze vision encoder
11/30/2024 12:06:22 - INFO - root - Loading pretrained model from /root/.cache/torch/hub/checkpoints/blip-diffusion
11/30/2024 12:06:22 - INFO - root - Loading pretrained BLIP2 Qformer weights.
11/30/2024 12:06:24 - INFO - root - Loading pretrained projection lyer weights.
11/30/2024 12:06:24 - INFO - root - Loading pretrained text encoder weights.
11/30/2024 12:06:25 - INFO - root - Loading pretrained vae weights.
11/30/2024 12:06:25 - INFO - root - Loading pretrained unet weights.
11/30/2024 12:06:33 - INFO - root - Using xformers.
11/30/2024 12:06:33 - INFO - root - Building datasets...
11/30/2024 12:06:43 - INFO - root - freeze vision encoder
11/30/2024 12:07:08 - INFO - root - load checkpoint from https://storage.googleapis.com/sfr-vision-language-research/LAVIS/models/BLIP2/blip2_pretrained_flant5xl.pth
11/30/2024 12:07:12 - INFO - __main__ - 
***** Running training *****
11/30/2024 12:07:12 - INFO - __main__ -   Num examples = 5
11/30/2024 12:07:12 - INFO - __main__ -   Num batches each epoch = 1
11/30/2024 12:07:12 - INFO - __main__ -   Num Epochs = 100
11/30/2024 12:07:12 - INFO - __main__ -   Instantaneous batch size per device = 6
11/30/2024 12:07:12 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 6
11/30/2024 12:07:12 - INFO - __main__ -   Gradient Accumulation steps = 1
11/30/2024 12:07:12 - INFO - __main__ -   Total optimization steps = 100
11/30/2024 12:07:12 - INFO - __main__ -   Total parameters number = 1995356906
11/30/2024 12:07:12 - INFO - __main__ -   Training parameters number = 576349697
11/30/2024 12:09:49 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:in the jungle.
11/30/2024 12:10:02 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/in_the_jungle/
11/30/2024 12:10:16 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/in_the_jungle/
11/30/2024 12:10:30 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/in_the_jungle/
11/30/2024 12:10:43 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/in_the_jungle/
11/30/2024 12:10:43 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:in the snow.
11/30/2024 12:10:57 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/in_the_snow/
11/30/2024 12:11:11 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/in_the_snow/
11/30/2024 12:11:24 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/in_the_snow/
11/30/2024 12:11:38 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/in_the_snow/
11/30/2024 12:11:38 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:on the beach.
11/30/2024 12:11:52 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_the_beach/
11/30/2024 12:12:05 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_the_beach/
11/30/2024 12:12:19 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_the_beach/
11/30/2024 12:12:32 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_the_beach/
11/30/2024 12:12:32 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:on a cobblestone street.
11/30/2024 12:12:46 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_a_cobblestone_street/
11/30/2024 12:13:00 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_a_cobblestone_street/
11/30/2024 12:13:13 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_a_cobblestone_street/
11/30/2024 12:13:27 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_a_cobblestone_street/
11/30/2024 12:13:27 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:on top of pink fabric.
11/30/2024 12:13:41 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_pink_fabric/
11/30/2024 12:13:54 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_pink_fabric/
11/30/2024 12:14:08 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_pink_fabric/
11/30/2024 12:14:22 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_pink_fabric/
11/30/2024 12:14:22 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:on top of a wooden floor.
11/30/2024 12:14:35 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_wooden_floor/
11/30/2024 12:14:49 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_wooden_floor/
11/30/2024 12:15:02 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_wooden_floor/
11/30/2024 12:15:16 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_wooden_floor/
11/30/2024 12:15:16 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:with a city in the background.
11/30/2024 12:15:30 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_city_in_the_background/
11/30/2024 12:15:43 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_city_in_the_background/
11/30/2024 12:15:57 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_city_in_the_background/
11/30/2024 12:16:11 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_city_in_the_background/
11/30/2024 12:16:11 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:with a mountain in the background.
11/30/2024 12:16:24 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_mountain_in_the_background/
11/30/2024 12:16:38 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_mountain_in_the_background/
11/30/2024 12:16:52 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_mountain_in_the_background/
11/30/2024 12:17:05 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_mountain_in_the_background/
11/30/2024 12:17:05 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:with a blue house in the background.
11/30/2024 12:17:19 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_blue_house_in_the_background/
11/30/2024 12:17:33 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_blue_house_in_the_background/
11/30/2024 12:17:46 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_blue_house_in_the_background/
11/30/2024 12:18:00 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_blue_house_in_the_background/
11/30/2024 12:18:00 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:on top of a purple rug in a forest.
11/30/2024 12:18:13 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_purple_rug_in_a_forest/
11/30/2024 12:18:27 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_purple_rug_in_a_forest/
11/30/2024 12:18:41 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_purple_rug_in_a_forest/
11/30/2024 12:18:54 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_purple_rug_in_a_forest/
11/30/2024 12:18:54 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:with a wheat field in the background.
11/30/2024 12:19:08 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_wheat_field_in_the_background/
11/30/2024 12:19:22 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_wheat_field_in_the_background/
11/30/2024 12:19:35 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_wheat_field_in_the_background/
11/30/2024 12:19:49 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_wheat_field_in_the_background/
11/30/2024 12:19:49 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:with a tree and autumn leaves in the background.
11/30/2024 12:20:03 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_tree_and_autumn_leaves_in_the_background/
11/30/2024 12:20:16 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_tree_and_autumn_leaves_in_the_background/
11/30/2024 12:20:30 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_tree_and_autumn_leaves_in_the_background/
11/30/2024 12:20:43 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_a_tree_and_autumn_leaves_in_the_background/
11/30/2024 12:20:43 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:with the Eiffel Tower in the background.
11/30/2024 12:20:57 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_the_Eiffel_Tower_in_the_background/
11/30/2024 12:21:11 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_the_Eiffel_Tower_in_the_background/
11/30/2024 12:21:24 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_the_Eiffel_Tower_in_the_background/
11/30/2024 12:21:38 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/with_the_Eiffel_Tower_in_the_background/
11/30/2024 12:21:38 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:floating on top of water.
11/30/2024 12:21:52 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/floating_on_top_of_water/
11/30/2024 12:22:05 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/floating_on_top_of_water/
11/30/2024 12:22:19 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/floating_on_top_of_water/
11/30/2024 12:22:33 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/floating_on_top_of_water/
11/30/2024 12:22:33 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:floating in an ocean of milk.
11/30/2024 12:22:46 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/floating_in_an_ocean_of_milk/
11/30/2024 12:23:00 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/floating_in_an_ocean_of_milk/
11/30/2024 12:23:14 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/floating_in_an_ocean_of_milk/
11/30/2024 12:23:27 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/floating_in_an_ocean_of_milk/
11/30/2024 12:23:27 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:on top of green grass with sunflowers around it.
11/30/2024 12:23:41 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_green_grass_with_sunflowers_around_it/
11/30/2024 12:23:54 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_green_grass_with_sunflowers_around_it/
11/30/2024 12:24:08 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_green_grass_with_sunflowers_around_it/
11/30/2024 12:24:22 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_green_grass_with_sunflowers_around_it/
11/30/2024 12:24:22 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:on top of a mirror.
11/30/2024 12:24:35 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_mirror/
11/30/2024 12:24:49 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_mirror/
11/30/2024 12:25:03 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_mirror/
11/30/2024 12:25:16 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_mirror/
11/30/2024 12:25:16 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:on top of the sidewalk in a crowded street.
11/30/2024 12:25:30 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_the_sidewalk_in_a_crowded_street/
11/30/2024 12:25:43 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_the_sidewalk_in_a_crowded_street/
11/30/2024 12:25:57 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_the_sidewalk_in_a_crowded_street/
11/30/2024 12:26:11 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_the_sidewalk_in_a_crowded_street/
11/30/2024 12:26:11 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:on top of a dirt road.
11/30/2024 12:26:24 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_dirt_road/
11/30/2024 12:26:38 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_dirt_road/
11/30/2024 12:26:52 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_dirt_road/
11/30/2024 12:27:05 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_dirt_road/
11/30/2024 12:27:05 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:on top of a white rug.
11/30/2024 12:27:19 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_white_rug/
11/30/2024 12:27:32 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_white_rug/
11/30/2024 12:27:46 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_white_rug/
11/30/2024 12:28:00 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/on_top_of_a_white_rug/
11/30/2024 12:28:00 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:red.
11/30/2024 12:28:13 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/red/
11/30/2024 12:28:27 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/red/
11/30/2024 12:28:41 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/red/
11/30/2024 12:28:54 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/red/
11/30/2024 12:28:54 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:purple.
11/30/2024 12:29:08 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/purple/
11/30/2024 12:29:22 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/purple/
11/30/2024 12:29:35 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/purple/
11/30/2024 12:29:49 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/purple/
11/30/2024 12:29:49 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:shiny.
11/30/2024 12:30:03 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/shiny/
11/30/2024 12:30:16 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/shiny/
11/30/2024 12:30:30 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/shiny/
11/30/2024 12:30:44 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/shiny/
11/30/2024 12:30:44 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:wet.
11/30/2024 12:30:57 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/wet/
11/30/2024 12:31:11 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/wet/
11/30/2024 12:31:25 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/wet/
11/30/2024 12:31:38 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/wet/
11/30/2024 12:31:38 - INFO - __main__ - Running validation... 
 Generating 4 images with prompt:cube shaped.
11/30/2024 12:31:52 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/cube_shaped/
11/30/2024 12:32:06 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/cube_shaped/
11/30/2024 12:32:19 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/cube_shaped/
11/30/2024 12:32:33 - INFO - root - Image have been saved in /shenzihe/WD-Disk/output/exp5/cat/checkpoint-100/images/cube_shaped/
